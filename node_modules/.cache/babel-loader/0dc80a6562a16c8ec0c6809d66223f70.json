{"ast":null,"code":"import _objectSpread from\"/home/trungnd2/Documents/project/new/insee-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/trungnd2/Documents/project/new/insee-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState}from\"react\";import{City,District}from'../src/utils/ProvinceUtil';import{getListForRetailer}from\"./utils/CementUtil\";import{ConfirmPhonePopup,ErrorPopup}from'../src/popup/index';import UserModel from'../src/model/UserModel';import\"./resource/App.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var owlClass=\"Register\";function Register(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),step=_useState4[0],setStep=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),errorMsg=_useState6[0],setErrorMsg=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isOpenConfirmPhonePopup=_useState8[0],setIsOpenConfirmPhonePopup=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isError=_useState10[0],setIsError=_useState10[1];var onSelectCement=function onSelectCement(cementId){var cements=form.cements?form.cements:[];if(cements.includes(cementId)){cements=cements.filter(function(e){return e!=cementId;});}else{cements.push(cementId);}setForm(_objectSpread(_objectSpread({},form),{},{cements:cements}));};var validate=function validate(){if(step==1){var phone=form.phone;var name=form.name;if(phone==null||phone.length<=1){setErrorMsg('Vui lòng nhập số điện thoại');return false;}if(name==null||name.length<=1){setErrorMsg('Vui lòng nhập chính xác tên của hàng của bạn');return false;}}else if(step==2){var cityId=form.cityId;var districtId=form.districtId;var address=form.address;if(!cityId||cityId==0){setErrorMsg('Vui chọn thành phố');return false;}if(!districtId||districtId==0){setErrorMsg('Vui lòng chọn quận huyện');return false;}if(!address){setErrorMsg('Vui lòng nhập địa chỉ cửa hàng');return false;}}setErrorMsg('');return true;};var onClickOkConfirmPhonePopup=function onClickOkConfirmPhonePopup(){setIsOpenConfirmPhonePopup(false);UserModel.checkPhone(form.phone).then(function(resp){if(resp.error==10){setErrorMsg('Anh chị không thể sử dụng số điện thoại này để đăng ký');return;}else if(resp.error===7){UserModel.register(form).then(function(resp){if(resp.error==0){window.location.href=\"/\";}else{setIsError(true);}});}else{setStep(2);}});};var onClickButton=function onClickButton(){if(validate()){if(step==1){setIsOpenConfirmPhonePopup(true);return;}if(step==3){UserModel.register(form).then(function(resp){if(resp.error==0){window.location.href=\"/\";}else{setIsError(true);}});return;}setStep(step+1);}};return/*#__PURE__*/_jsxs(\"div\",{className:owlClass,children:[form.phone&&form.name&&/*#__PURE__*/_jsx(ConfirmPhonePopup,{phone:form.phone,storeName:form.name,onAgree:function onAgree(){onClickOkConfirmPhonePopup();},onCloseModal:function onCloseModal(){setIsOpenConfirmPhonePopup(false);},open:isOpenConfirmPhonePopup}),isError&&/*#__PURE__*/_jsx(ErrorPopup,{open:isError,onCloseModal:function onCloseModal(){setIsError(false);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(owlClass,\"__title\"),children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0110\\u0102NG K\\xDD TH\\xD4NG TIN\"}),/*#__PURE__*/_jsx(\"div\",{className:\"line-title\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{className:\"line-item \".concat(step==1&&'active')}),/*#__PURE__*/_jsx(\"li\",{className:\"line-item \".concat(step==2&&'active')}),/*#__PURE__*/_jsx(\"li\",{className:\"line-item \".concat(step==3&&'active')})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(owlClass,\"__content\"),children:[step==1&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(owlClass,\"__content___form-group\"),children:[/*#__PURE__*/_jsx(\"p\",{children:\"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"}),/*#__PURE__*/_jsx(\"input\",{value:form.phone,onChange:function onChange(e){setForm(_objectSpread(_objectSpread({},form),{},{phone:e.currentTarget.value}));}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(owlClass,\"__content___form-group\"),children:[/*#__PURE__*/_jsx(\"p\",{children:\"T\\xEAn c\\u1EEDa h\\xE0ng\"}),/*#__PURE__*/_jsx(\"input\",{value:form.name,onChange:function onChange(e){setForm(_objectSpread(_objectSpread({},form),{},{name:e.currentTarget.value}));}})]})]}),step==2&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(owlClass,\"__content___form-group\"),children:[/*#__PURE__*/_jsx(\"p\",{children:\"T\\u1EC9nh/th\\xE0nh\"}),/*#__PURE__*/_jsxs(\"select\",{value:form.cityId,onChange:function onChange(e){setForm(_objectSpread(_objectSpread({},form),{},{cityId:Number(e.currentTarget.value)}));},children:[(!form.cityId||form.cityId==0)&&/*#__PURE__*/_jsx(\"option\",{value:0}),City.getList().map(function(value){return/*#__PURE__*/_jsx(\"option\",{value:value.key,children:value.value},value.key);})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(owlClass,\"__content___form-group\"),children:[/*#__PURE__*/_jsx(\"p\",{children:\"Qu\\u1EADn/huy\\u1EC7n\"}),/*#__PURE__*/_jsxs(\"select\",{value:form.districtId,onChange:function onChange(e){setForm(_objectSpread(_objectSpread({},form),{},{districtId:Number(e.currentTarget.value)}));},children:[(!form.districtId||form.districtId==0)&&/*#__PURE__*/_jsx(\"option\",{value:0}),form.cityId&&form.cityId!=0&&District.getList(form.cityId).map(function(value){return/*#__PURE__*/_jsx(\"option\",{value:value.key,children:value.value},value.key);})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(owlClass,\"__content___form-group\"),children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u0110\\u1ECBa ch\\u1EC9\"}),/*#__PURE__*/_jsx(\"input\",{value:form.address,onChange:function onChange(e){setForm(_objectSpread(_objectSpread({},form),{},{address:e.currentTarget.value}));}})]})]}),step==3&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(owlClass,\"__content___form-group\"),children:[/*#__PURE__*/_jsx(\"p\",{children:\"S\\u1EA3n ph\\u1EA9m\"}),getListForRetailer().map(function(value){return/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(owlClass,\"__content___form-group__cement-item\"),onClick:function onClick(){onSelectCement(Number(value.id));},children:[/*#__PURE__*/_jsx(\"input\",{checked:form.cements?form.cements.includes(Number(value.id)):false,type:\"checkbox\"}),/*#__PURE__*/_jsx(\"p\",{children:value.name})]});})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{paddingTop:'40px',textAlign:'center'},children:[errorMsg&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:errorMsg}),/*#__PURE__*/_jsx(\"div\",{onClick:function onClick(){onClickButton();},className:\"\".concat(owlClass,\"__content__group-btn\"),children:\"\\u0110\\u0103ng k\\xFD\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(owlClass,\"__footer\"),children:/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(owlClass,\"__footer__wrapper\"),children:/*#__PURE__*/_jsx(\"img\",{src:\"https://ximanginsee.gapit.com.vn/html/images/logo.png\",height:'30px',alt:\"Insee\"})})})]});}export default Register;","map":{"version":3,"sources":["/home/trungnd2/Documents/project/new/insee-client/src/Register.tsx"],"names":["useState","City","District","getListForRetailer","ConfirmPhonePopup","ErrorPopup","UserModel","owlClass","Register","form","setForm","step","setStep","errorMsg","setErrorMsg","isOpenConfirmPhonePopup","setIsOpenConfirmPhonePopup","isError","setIsError","onSelectCement","cementId","cements","includes","filter","e","push","validate","phone","name","length","cityId","districtId","address","onClickOkConfirmPhonePopup","checkPhone","then","resp","error","register","window","location","href","onClickButton","currentTarget","value","Number","getList","map","key","id","paddingTop","textAlign"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\nimport { RegisterForm } from '../src/interface/index';\nimport { City, District } from '../src/utils/ProvinceUtil'\nimport { getListForRetailer } from \"./utils/CementUtil\";\nimport { ConfirmPhonePopup, ErrorPopup } from '../src/popup/index';\nimport UserModel from '../src/model/UserModel'\n\nimport \"./resource/App.scss\";\nconst owlClass = \"Register\";\n\nfunction Register() {\n  const [form, setForm] = useState<RegisterForm>({} as RegisterForm)\n  const [step, setStep] = useState(1)\n  const [errorMsg, setErrorMsg] = useState<string>()\n  const [isOpenConfirmPhonePopup, setIsOpenConfirmPhonePopup] = useState(false)\n  const [isError, setIsError] = useState(false)\n\n  const onSelectCement = (cementId: number) => {\n    let cements = form.cements ? form.cements : [];\n    if (cements.includes(cementId)) {\n      cements = cements.filter((e) => e != cementId);\n    } else {\n      cements.push(cementId)\n    }\n    setForm({ ...form, cements: cements })\n  }\n\n  const validate = () => {\n    if (step == 1) {\n      let phone = form.phone;\n      let name = form.name;\n      if (phone == null || phone.length <= 1) {\n        setErrorMsg('Vui lòng nhập số điện thoại')\n        return false;\n      }\n      if (name == null || name.length <= 1) {\n        setErrorMsg('Vui lòng nhập chính xác tên của hàng của bạn')\n        return false;\n      }\n    } else if (step == 2) {\n      let cityId = form.cityId;\n      let districtId = form.districtId;\n      let address = form.address;\n      if (!cityId || cityId == 0) {\n        setErrorMsg('Vui chọn thành phố')\n        return false;\n      }\n      if (!districtId || districtId == 0) {\n        setErrorMsg('Vui lòng chọn quận huyện')\n        return false;\n      }\n\n      if (!address) {\n        setErrorMsg('Vui lòng nhập địa chỉ cửa hàng')\n        return false;\n      }\n    }\n\n    setErrorMsg('')\n    return true;\n  }\n\n  const onClickOkConfirmPhonePopup = () => {\n    setIsOpenConfirmPhonePopup(false);\n    UserModel.checkPhone(form.phone)\n      .then(resp => {\n        if (resp.error == 10) {\n          setErrorMsg('Anh chị không thể sử dụng số điện thoại này để đăng ký')\n          return;\n        } else if (resp.error === 7) {\n          UserModel.register(form)\n            .then(resp => {\n              if (resp.error == 0) {\n                window.location.href = \"/\"\n              } else {\n                setIsError(true)\n              }\n            })\n        } else {\n          setStep(2)\n        }\n      })\n  }\n\n  const onClickButton = () => {\n    if (validate()) {\n      if (step == 1) {\n        setIsOpenConfirmPhonePopup(true)\n        return;\n      }\n      if (step == 3) {\n        UserModel.register(form)\n          .then(resp => {\n            if (resp.error == 0) {\n              window.location.href = \"/\"\n            } else {\n              setIsError(true)\n            }\n          })\n        return;\n      }\n      setStep(step + 1)\n    }\n  }\n\n\n  return (\n    <div className={owlClass}>\n      {form.phone && form.name &&\n        <ConfirmPhonePopup phone={form.phone} storeName={form.name}\n          onAgree={() => {\n            onClickOkConfirmPhonePopup()\n          }\n          }\n          onCloseModal={() => { setIsOpenConfirmPhonePopup(false) }}\n          open={isOpenConfirmPhonePopup} />\n      }\n      {isError && <ErrorPopup open={isError} onCloseModal={() => { setIsError(false) }} />}\n      <div className={`${owlClass}__title`}>\n        <h2>ĐĂNG KÝ THÔNG TIN</h2>\n        <div className=\"line-title\">\n          <ul>\n            <li className={`line-item ${step == 1 && 'active'}`}></li>\n            <li className={`line-item ${step == 2 && 'active'}`}></li>\n            <li className={`line-item ${step == 3 && 'active'}`}></li>\n          </ul>\n        </div>\n      </div>\n      <div className={`${owlClass}__content`}>\n        {step == 1 &&\n          <>\n            <div className={`${owlClass}__content___form-group`}>\n              <p>Số điện thoại</p>\n              <input value={form.phone}\n                onChange={(e: React.FormEvent<HTMLInputElement>) => { setForm({ ...form, phone: e.currentTarget.value }) }} />\n            </div>\n            <div className={`${owlClass}__content___form-group`}>\n              <p>Tên cửa hàng</p>\n              <input value={form.name}\n                onChange={(e: React.FormEvent<HTMLInputElement>) => { setForm({ ...form, name: e.currentTarget.value }) }} />\n            </div>\n          </>\n        }\n        {step == 2 &&\n          <>\n            <div className={`${owlClass}__content___form-group`}>\n              <p>Tỉnh/thành</p>\n              <select value={form.cityId} onChange={(e: React.FormEvent<HTMLSelectElement>) => { setForm({ ...form, cityId: Number(e.currentTarget.value) }) }}>\n                {(!form.cityId || form.cityId == 0) &&\n                  <option value={0}></option>\n                }\n                {City.getList().map((value) => {\n                  return (\n                    <option key={value.key} value={value.key}>{value.value}</option>\n                  )\n                })}\n              </select>\n            </div>\n\n            <div className={`${owlClass}__content___form-group`}>\n              <p>Quận/huyện</p>\n              <select value={form.districtId} onChange={(e: React.FormEvent<HTMLSelectElement>) => { setForm({ ...form, districtId: Number(e.currentTarget.value) }) }}>\n                {(!form.districtId || form.districtId == 0) &&\n                  <option value={0}></option>\n                }\n                {(form.cityId && form.cityId != 0) && District.getList(form.cityId).map((value) => {\n                  return (\n                    <option key={value.key} value={value.key}>{value.value}</option>\n                  )\n                })}\n              </select>\n            </div>\n            <div className={`${owlClass}__content___form-group`}>\n              <p>Địa chỉ</p>\n              <input value={form.address}\n                onChange={(e: React.FormEvent<HTMLInputElement>) => { setForm({ ...form, address: e.currentTarget.value }) }} />\n            </div>\n          </>\n        }\n        {step == 3 &&\n          <>\n            <div className={`${owlClass}__content___form-group`}>\n              <p>Sản phẩm</p>\n              {getListForRetailer().map(value => {\n                return (\n                  <div className={`${owlClass}__content___form-group__cement-item`} onClick={() => { onSelectCement(Number(value.id)) }}>\n                    <input checked={form.cements ? form.cements.includes(Number(value.id)) : false} type=\"checkbox\" />\n                    <p>{value.name}</p>\n                  </div>\n                )\n              })}\n            </div>\n          </>\n        }\n        <div style={{ paddingTop: '40px', textAlign: 'center' }}>\n          {errorMsg && <p className=\"error\">{errorMsg}</p>}\n          <div onClick={() => { onClickButton() }} className={`${owlClass}__content__group-btn`}>Đăng ký</div>\n        </div>\n      </div>\n      <div className={`${owlClass}__footer`}>\n        <div className={`${owlClass}__footer__wrapper`}>\n          <img src=\"https://ximanginsee.gapit.com.vn/html/images/logo.png\" height={'30px'} alt=\"Insee\" />\n        </div>\n      </div>\n    </div >\n  );\n}\n\nexport default Register;\n"]},"metadata":{},"sourceType":"module"}